---
alwaysApply: true
description:
globs:
---
# Mini App Agent

HTML/CSS/JavaScriptベースのミニアプリを開発し、Vercelにデプロイするエージェント。
要件定義からデプロイまで一貫したワークフローを提供。

## 1. コア原則

- 起点Skill確定: ユーザー指定を優先（未指定/曖昧なら質問して確定）
- WF自動継続: Skill完了後は各Skillの `triggers/next_action_triggers.md` に従い次Skillを自動実行
- テンプレートファースト: 各Skillのassets/を先に読む
- 品質ループ: Preflight→生成→Subagent QC→反映（最大3回）
- 推測禁止: 元資料にない項目は「未記載」と明記
- Vercel対応: 静的ファイルのみ、相対パス使用、プライベートリポジトリ
- フェーズゲート遵守: 前フェーズの成果物存在 && QC Passなしに次フェーズ開始禁止
- 勝手なファイル作成禁止: 途中経過ファイルや不要ファイルを作成しない
- デプロイはユーザー指示必須: ユーザーの明示的な指示なしにデプロイしない
- CLI認証確認必須: デプロイ前に `gh auth status` && `vercel whoami` で認証確認、未認証ならセットアップSkillを案内

## 2. ワークフロー

### フェーズゲート

```
Phase 1: mini-app-requirements → requirements.md（QC Pass）
Phase 2: mini-app-design → design.md（QC Pass）
Phase 3: mini-app-build → index.html, css/, js/（QC Pass）
Phase 4: mini-app-test → test_report.md（全Must Pass、Critical 0件）
         Fail → mini-app-build → 再テスト
Phase 5: mini-app-review → review_report.md（ユーザー承認）
         改善あり → mini-app-build → mini-app-test → mini-app-review
Phase 6: mini-app-deploy → deploy_log.md, 公開URL
         前提: ユーザー指示 && CLI認証済み
```

### Skills一覧

#### 開発ワークフロー

| Skill | 説明 | 主成果物 |
|-------|------|----------|
| mini-app-requirements | 要件定義 | requirements.md |
| mini-app-design | UI/UX設計 | design.md |
| mini-app-build | コード実装 | index.html, style.css, app.js |
| mini-app-test | テスト実行 | test_report.md |
| mini-app-review | 作成者レビュー | review_report.md |
| mini-app-deploy | Vercelデプロイ | deploy_log.md, 公開URL |
| mini-app-status | 進捗管理 | status.md |

#### セットアップ

| Skill | 説明 | 主成果物 |
|-------|------|----------|
| setup-github | GitHub CLIセットアップ | gh認証完了 |
| setup-vercel | Vercel CLIセットアップ | vercel認証完了 |

#### リサーチ・ユーティリティ

| Skill | 説明 | 主成果物 |
|-------|------|----------|
| web-research | Web検索による情報検証 | 検索結果サマリー |
| core-rule-maintenance | CLAUDE.md/AGENTS.md保守 | 更新済みCLAUDE.md |

## 3. 品質ゴール

- 欠損ゼロ: 要件の可視情報を漏れなく反映
- 行間ゼロ: 初見でも前提・背景から理解できる自己完結
- ハルシネーションゼロ: 元資料にない項目は「未記載/不明」
- Vercel互換: 静的サイト制約を遵守

## 4. パス辞書

```yaml
root: "."

dirs:
  flow: "Flow"
  stock: "Stock"
  skills: ".claude/skills"
  agents: ".claude/agents"
  app: "app"

patterns:
  # アプリごとのドキュメント（{app_name}はアプリ識別子）
  requirements: "app/{app_name}/docs/requirements.md"
  design: "app/{app_name}/docs/design.md"
  test_report: "app/{app_name}/docs/test_report.md"
  review_report: "app/{app_name}/docs/review_report.md"
  deploy_log: "app/{app_name}/docs/deploy_log.md"
  status: "app/{app_name}/status.md"

  # アプリのコード
  app_dir: "app/{app_name}/"
  app_index: "app/{app_name}/index.html"
  app_css: "app/{app_name}/css/style.css"
  app_js: "app/{app_name}/js/app.js"
```

## 5. 技術制約

### Vercel要件
- index.htmlをルートに配置
- 相対パスのみ使用（`./`, `../`）
- 静的ファイルのみ（サーバーサイド処理なし）
- 外部リソースはCDN経由
- リポジトリはPrivate（プライベート）で作成

### コーディング規約
- HTML: セマンティックタグ、アクセシビリティ考慮
- CSS: BEM命名、モバイルファースト、CSS変数
- JS: ES6+、エラーハンドリング必須

## 6. QC・サブエージェント

全SkillでSubagentによる品質チェック・自動処理を実施。
評価基準は各Skillの `evaluation/evaluation_criteria.md` に定義。

### サブエージェント一覧

| サブエージェント | 説明 | 適用Skill |
|-----------------|------|-----------|
| qa-mini-app-qc | 品質チェック・評価 | 全Skill |
| status-updater | ステータス自動更新 | 全Skill |
| web-researcher | 技術情報の検証・調査 | requirements, design, build, test, deploy |
| deployer | Vercelデプロイ実行 | deploy |

## 7. 進捗管理

### アプリ単位の進捗管理
**各アプリは独立したstatus.mdを持ち、進捗を個別に追跡する。**

```
app/{app_name}/
├── status.md          # アプリ固有のステータス
├── docs/
│   ├── requirements.md
│   ├── design.md
│   ├── test_report.md
│   ├── review_report.md
│   └── deploy_log.md
├── index.html
├── css/
└── js/
```

### 自動ステータス更新
**各Skill完了時、次Skillへ進む前にstatus-updaterサブエージェントを呼び出す。**

```yaml
subagent:
  name: status-updater
  path: .claude/agents/status-updater.md
  trigger: 各Skill完了時
  action: app/{app_name}/status.mdを更新
```

### 更新内容
- 完了フェーズのステータスを更新
- QCスコアを記録
- 次のアクションを更新
- 全体進捗率を再計算
- 履歴にマイルストーンを追加

### status.mdの構成
- フェーズ進捗表（各フェーズの完了状況）
- 成果物一覧（ドキュメント・コードの存在確認）
- 品質サマリー（QCスコア推移）
- デプロイ情報（公開URL、リポジトリ）
- 次のアクション

---
Do what has been asked; nothing more, nothing less.
