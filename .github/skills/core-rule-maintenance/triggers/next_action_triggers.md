# Core Rule Maintenance Next Action Triggers

## 自動実行ルール
**以下の条件を満たす場合は、該当Skillを必ず実行すること（WF自動継続）。**
条件判定はSkill完了時に自動で行い、スキップ条件に該当しない限り次Skillへ進む。

## 起動条件テーブル

| ID | 起動条件 | 実行Skill/スクリプト | 優先度 | 備考 |
|----|---------|---------------------|--------|------|
| T1 | CLAUDE.mdを変更した | `update_agent_master.py` 実行 | 1 | 3環境同期は必須 |
| T2 | Section 6（WF索引）を変更した | 影響を受けるSkillsのtriggers更新 | 1 | 双方向整合性維持 |
| T3 | Section 7（パス辞書）を変更した | 該当パスを使用するSkillsの確認 | 2 | 使用箇所の動作確認 |
| T4 | 新規Skillを追加した（WF索引） | `skill-maintenance` | 2 | Skill本体が未作成の場合 |
| T5 | コア原則（Section 1）を変更した | 主要Skillsの整合性確認 | 2 | 全Skillsに影響する変更 |

## スキップ条件
以下の場合のみ、起動条件を満たしても実行をスキップできる:
- ユーザーが明示的に「CLAUDE.mdのみ編集」と指定した場合
- コメント追加のみの変更（機能に影響なし）
- 3環境同期が直前に実行済みで差分がない場合

## 条件判定ロジック
1. Skill完了時、起動条件テーブルを上から順に評価する
2. 条件を満たす行があれば、スキップ条件を確認する
3. スキップ条件に該当しなければ、該当Skill/スクリプトを実行する
4. 複数条件が該当する場合は、優先度順に全て実行する

## triggers更新時の絶対ルール

**元々あったネクストアクションは絶対に欠損させない。**

triggers/next_action_triggers.md を更新する際は以下を厳守すること:
1. 更新前に必ずオリジナルのSKILL.mdのNext Actionセクションを確認する
2. オリジナルに記載されている全ての連携先Skillを起動条件テーブルに含める
3. 連携先Skillが存在するか確認し、存在しない場合のみ「連携先未定義」として記録する
4. 新規追加は許可するが、既存の連携先の削除・省略は禁止
5. 更新後、オリジナルとtriggersの連携先が一致しているか必ず検証する

## 補足: WF索引変更時のtriggers更新

WF索引で `A → B` を追加/変更した場合:

1. Skill A の `triggers/next_action_triggers.md` を確認
2. Skill B への起動条件が定義されているか確認
3. 未定義なら追加:
   ```markdown
   | TX | {Aの成果物条件} | `B` | 1 | WF索引整合 |
   ```
